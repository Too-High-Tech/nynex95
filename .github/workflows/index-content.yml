name: "Index Content"
on:
  push:
    # paths:
    # - 'content/**'

jobs:
  index-content:
    name: index-content
    runs-on: ubuntu-18.04

    steps:
      - name: checkout.
        uses: actions/checkout@v2

      - name: Build the main index.
        run:  find ./content/ -type f | jq -R -s -c 'split("\n")|.[0:-1]' | tee index/main.json

      - name: Commit & push any if changes are found
        run:  |
          test -n "$(git status -s)"
            && echo "Changes"
            && git commit -nam 'Indexing content.'
            && git push

